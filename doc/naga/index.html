<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Universal shader translator."><meta name="keywords" content="rust, rustlang, rust-lang, naga"><title>naga - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../ayu.css" disabled ><script id="default-settings"></script><script src="../storage.js"></script><script src="../crates.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../favicon.svg">
<link rel="alternate icon" type="image/png" href="../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../naga/index.html'><div class='logo-container rust-logo'><img src='../rust-logo.png' alt='logo'></div></a><p class="location">Crate naga</p><div class="block version"><p>Version 0.4.0</p></div><div class="sidebar-elems"><a id="all-types" href="all.html"><p>See all naga's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li><li><a href="#constants">Constants</a></li><li><a href="#types">Type Definitions</a></li></ul></div><div id="sidebar-vars" data-name="naga" data-ty="mod" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img src="../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../settings.html" title="settings"><img src="../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Crate <a class="mod" href="#">naga</a><button id="copy-path" onclick="copy_path(this)" title="copy path"><img src="../clipboard.svg" width="19" height="18" alt="Copy item import" title="Copy item import to clipboard"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../src/naga/lib.rs.html#1-1146" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Universal shader translator.</p>
<p>The central structure of the crate is <a href="struct.Module.html" title="Module"><code>Module</code></a>. A <code>Module</code> contains:</p>
<ul>
<li>
<p><a href="struct.EntryPoint.html" title="EntryPoint"><code>EntryPoint</code></a>s, the main functions for pipeline stages like vertex shading or
fragment shading,</p>
</li>
<li>
<p><a href="struct.Function.html" title="Function"><code>Function</code></a>s, representing functions used by <code>EntryPoint</code>s and other <code>Function</code>s,</p>
</li>
<li>
<p><a href="struct.Constant.html" title="Constant"><code>Constant</code></a>s and <a href="struct.GlobalVariable.html" title="GlobalVariable"><code>GlobalVariable</code></a>s used by <code>EntryPoint</code>s and <code>Function</code>s, and</p>
</li>
<li>
<p><a href="struct.Type.html" title="Type"><code>Type</code></a>s used by the above.</p>
</li>
</ul>
<p>The body of an <code>EntryPoint</code> or <code>Function</code> is represented using two types:</p>
<ul>
<li>
<p>An <a href="enum.Expression.html" title="Expression"><code>Expression</code></a> produces a value, but has no side effects or control flow.
<code>Expressions</code> include variable references, unary and binary operators, and so
on.</p>
</li>
<li>
<p>A <a href="enum.Statement.html" title="Statement"><code>Statement</code></a> can have side effects and structured control flow.
<code>Statement</code>s do not produce a value, other than by storing one in some
designated place. <code>Statements</code> include blocks, conditionals, and loops, but also
operations that have side effects, like stores and function calls.</p>
</li>
</ul>
<p><code>Statement</code>s form a tree, with pointers into the DAG of <code>Expression</code>s.</p>
<p>Restricting side effects to statements simplifies analysis and code generation.
A Naga backend can generate code to evaluate an <code>Expression</code> however and
whenever it pleases, as long as it is certain to observe the side effects of all
previously executed <code>Statement</code>s.</p>
<p>Many <code>Statement</code> variants use the <a href="type.Block.html" title="Block"><code>Block</code></a> type, which is simply <code>Vec&lt;Block&gt;</code>,
representing a series of statements executed in order. The body of an
<code>EntryPoint</code>s or <code>Function</code> is a <code>Block</code>, and <code>Statement</code> has a
<a href="enum.Statement.html#variant.Block" title="Statement::Block"><code>Block</code></a> variant.</p>
<p>To improve translator performance and reduce memory usage, most structures are
stored in an <a href="struct.Arena.html" title="Arena"><code>Arena</code></a>. An <code>Arena&lt;T&gt;</code> stores a series of <code>T</code> values, indexed by
<a href="struct.Handle.html"><code>Handle&lt;T&gt;</code></a> values, which are just wrappers around integer indexes.
For example, a <code>Function</code>’s expressions are stored in an <code>Arena&lt;Expression&gt;</code>,
and compound expressions refer to their sub-expressions via <code>Handle&lt;Expression&gt;</code>
values. (When examining the serialized form of a <code>Module</code>, note that the first
element of an <code>Arena</code> has an index of 1, not 0.)</p>
<h2 id="function-calls" class="section-header"><a href="#function-calls">Function Calls</a></h2>
<p>The Naga IR’s representation of function calls is unusual. Most languages treat
function calls as expressions, but because calls may have side effects, Naga
represents them with <a href="enum.Statement.html#variant.Call" title="Statement::Call"><code>Statement::Call</code></a>. A call statement may designate a
particular <code>Expression</code> to represent its return value, if any, which can be used
by subsequent statements and their expressions.</p>
<h2 id="expression-evaluation-time-and-scope" class="section-header"><a href="#expression-evaluation-time-and-scope"><code>Expression</code> evaluation time and scope</a></h2>
<p>While the order of execution of <a href="enum.Statement.html" title="Statement"><code>Statement</code></a>s is apparent from their structure,
it is not so obvious exactly when a given <a href="enum.Expression.html" title="Expression"><code>Expression</code></a> should be evaluated,
since many <code>Statement</code>s and <code>Expression</code>s may refer to its value. But it is
essential to clearly specify an expression’s evaluation time, since that
determines which statements’ effects the expression should observe. It is also
helpful to backends to limit the visibility of an <code>Expression</code>’s value to a
portion of the statement tree.</p>
<p>An <code>Expression</code> may only be used, whether by a <code>Statement</code> or another
<code>Expression</code>, if one of the following is true:</p>
<ul>
<li>
<p>The expression is an <a href="enum.Expression.html#variant.Constant" title="Expression::Constant"><code>Expression::Constant</code></a>, <a href="enum.Expression.html#variant.FunctionArgument" title="Expression::FunctionArgument"><code>Expression::FunctionArgument</code></a>, or
<a href="enum.Expression.html#variant.GlobalVariable" title="Expression::GlobalVariable"><code>Expression::GlobalVariable</code></a>.</p>
</li>
<li>
<p>The expression is an <a href="enum.Expression.html#variant.LocalVariable" title="Expression::LocalVariable"><code>Expression::LocalVariable</code></a> that is either the
<code>pointer</code> (destination) of a <a href="enum.Statement.html#variant.Store" title="Statement::Store"><code>Statement::Store</code></a>, or initialized by some
previously executed <code>Statement::Store</code>.</p>
</li>
<li>
<p>The expression is the <code>result</code> of a <a href="enum.Statement.html#variant.Call" title="Statement::Call"><code>Statement::Call</code></a>, representing the
call’s return value. The call must be ‘in scope’ for the use (see below).</p>
</li>
<li>
<p>The expression is included in the range of some <a href="enum.Statement.html#variant.Emit" title="Statement::Emit"><code>Statement::Emit</code></a> that is
‘in scope’ for the use (see below). The <a href="enum.Expression.html#method.needs_pre_emit" title="Expression::needs_pre_emit"><code>Expression::needs_pre_emit</code></a> method
returns <code>true</code> if the given expression does <em>not</em> need to be covered by an
<code>Emit</code> statement.</p>
</li>
</ul>
<p>The scope of an expression evaluated by an <code>Emit</code> statement covers the
subsequent expressions in that <code>Emit</code>, any following statements in the <code>Block</code>
to which that <code>Emit</code> belongs (if any) and their sub-statements (if any).</p>
<p>If a <code>Call</code> statement has a <code>result</code> expression, then it is in scope for any
statements following the <code>Call</code> in the <code>Block</code> to which that <code>Call</code> belongs (if
any) and their sub-statements (if any).</p>
<p>This means that, for example, an expression evaluated by some statement in a
nested <code>Block</code> is not available in the <code>Block</code>’s parents. Such a value would
need to be stored in a local variable to be carried upwards in the statement
tree.</p>
<h2 id="variables" class="section-header"><a href="#variables">Variables</a></h2>
<p>An <a href="enum.Expression.html#variant.LocalVariable" title="Expression::LocalVariable"><code>Expression::LocalVariable</code></a> or <a href="enum.Expression.html#variant.GlobalVariable" title="Expression::GlobalVariable"><code>Expression::GlobalVariable</code></a> produces a
pointer value referring to the variable’s value. To retrieve the variable’s
value, use an <a href="enum.Expression.html#variant.Load" title="Expression::Load"><code>Expression::Load</code></a>, with the variable expression as its
<code>pointer</code> operand. To assign to a variable, use a <a href="enum.Statement.html#variant.Store" title="Statement::Store"><code>Statement::Store</code></a> with the
variable expression as its <code>pointer</code> operand.</p>
<p>As an exception, <a href="enum.Expression.html#variant.GlobalVariable" title="Expression::GlobalVariable"><code>Expression::GlobalVariable</code></a>s referring to
<a href="struct.GlobalVariable.html" title="GlobalVariable"><code>GlobalVariable</code></a>s whose <code>class</code> is <a href="enum.StorageClass.html#variant.Handle" title="StorageClass::Handle"><code>StorageClass::Handle</code></a> produce the
variable’s value directly; no <code>Load</code> is needed. These global variables refer to
opaque values like samplers and images.</p>
</div></details><h2 id="modules" class="section-header"><a href="#modules">Modules</a></h2>
<table><tr class="module-item"><td><a class="mod" href="back/index.html" title="naga::back mod">back</a></td><td class="docblock-short"><p>Functions which export shader modules into binary and text formats.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="front/index.html" title="naga::front mod">front</a></td><td class="docblock-short"><p>Parsers which load shaders into memory.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="proc/index.html" title="naga::proc mod">proc</a></td><td class="docblock-short"><p>Module processing functionality.</p>
</td></tr><tr class="module-item"><td><a class="mod" href="valid/index.html" title="naga::valid mod">valid</a></td><td class="docblock-short"></td></tr></table><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<table><tr class="module-item"><td><a class="struct" href="struct.Arena.html" title="naga::Arena struct">Arena</a></td><td class="docblock-short"><p>An arena holding some kind of component (e.g., type, constant,
instruction, etc.) that can be referenced.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Barrier.html" title="naga::Barrier struct">Barrier</a></td><td class="docblock-short"><p>Memory barrier flags.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Constant.html" title="naga::Constant struct">Constant</a></td><td class="docblock-short"><p>Constant value.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.EarlyDepthTest.html" title="naga::EarlyDepthTest struct">EarlyDepthTest</a></td><td class="docblock-short"><p>Early fragment tests. In a standard situation if a driver determines that it is possible to
switch on early depth test it will. Typical situations when early depth test is switched off:</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.EntryPoint.html" title="naga::EntryPoint struct">EntryPoint</a></td><td class="docblock-short"><p>Exported function, to be run at a certain stage in the pipeline.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Function.html" title="naga::Function struct">Function</a></td><td class="docblock-short"><p>A function defined in the module.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FunctionArgument.html" title="naga::FunctionArgument struct">FunctionArgument</a></td><td class="docblock-short"><p>A function argument.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.FunctionResult.html" title="naga::FunctionResult struct">FunctionResult</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="struct" href="struct.GlobalVariable.html" title="naga::GlobalVariable struct">GlobalVariable</a></td><td class="docblock-short"><p>Variable defined at module level.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Handle.html" title="naga::Handle struct">Handle</a></td><td class="docblock-short"><p>A strongly typed reference to an arena item.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.LocalVariable.html" title="naga::LocalVariable struct">LocalVariable</a></td><td class="docblock-short"><p>Variable defined at function level.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Module.html" title="naga::Module struct">Module</a></td><td class="docblock-short"><p>Shader module.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Range.html" title="naga::Range struct">Range</a></td><td class="docblock-short"><p>A strongly typed range of handles.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.ResourceBinding.html" title="naga::ResourceBinding struct">ResourceBinding</a></td><td class="docblock-short"><p>Pipeline binding information for global resources.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.StorageAccess.html" title="naga::StorageAccess struct">StorageAccess</a></td><td class="docblock-short"><p>Flags describing an image.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.StructMember.html" title="naga::StructMember struct">StructMember</a></td><td class="docblock-short"><p>Member of a user-defined structure.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.SwitchCase.html" title="naga::SwitchCase struct">SwitchCase</a></td><td class="docblock-short"><p>A case for a switch statement.</p>
</td></tr><tr class="module-item"><td><a class="struct" href="struct.Type.html" title="naga::Type struct">Type</a></td><td class="docblock-short"><p>A data type declared in the module.</p>
</td></tr></table><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<table><tr class="module-item"><td><a class="enum" href="enum.ArraySize.html" title="naga::ArraySize enum">ArraySize</a></td><td class="docblock-short"><p>Size of an array.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.BinaryOperator.html" title="naga::BinaryOperator enum">BinaryOperator</a></td><td class="docblock-short"><p>Operation that can be applied on two values.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.Binding.html" title="naga::Binding enum">Binding</a></td><td class="docblock-short"><p>Describes how an input/output variable is to be bound.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.BuiltIn.html" title="naga::BuiltIn enum">BuiltIn</a></td><td class="docblock-short"><p>Built-in inputs and outputs.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ConservativeDepth.html" title="naga::ConservativeDepth enum">ConservativeDepth</a></td><td class="docblock-short"><p>Enables adjusting depth without disabling early Z.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ConstantInner.html" title="naga::ConstantInner enum">ConstantInner</a></td><td class="docblock-short"><p>Additional information, dependent on the kind of constant.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.DerivativeAxis.html" title="naga::DerivativeAxis enum">DerivativeAxis</a></td><td class="docblock-short"><p>Axis on which to compute a derivative.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.Expression.html" title="naga::Expression enum">Expression</a></td><td class="docblock-short"><p>An expression that can be evaluated to obtain a value.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ImageClass.html" title="naga::ImageClass enum">ImageClass</a></td><td class="docblock-short"><p>Sub-class of the image type.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ImageDimension.html" title="naga::ImageDimension enum">ImageDimension</a></td><td class="docblock-short"><p>The number of dimensions an image has.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ImageQuery.html" title="naga::ImageQuery enum">ImageQuery</a></td><td class="docblock-short"><p>Type of an image query.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.Interpolation.html" title="naga::Interpolation enum">Interpolation</a></td><td class="docblock-short"><p>The interpolation qualifier of a binding or struct field.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.MathFunction.html" title="naga::MathFunction enum">MathFunction</a></td><td class="docblock-short"><p>Built-in shader function for math.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.RelationalFunction.html" title="naga::RelationalFunction enum">RelationalFunction</a></td><td class="docblock-short"><p>Built-in shader function for testing relation between values.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.SampleLevel.html" title="naga::SampleLevel enum">SampleLevel</a></td><td class="docblock-short"><p>Sampling modifier to control the level of detail.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.Sampling.html" title="naga::Sampling enum">Sampling</a></td><td class="docblock-short"><p>The sampling qualifiers of a binding or struct field.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ScalarKind.html" title="naga::ScalarKind enum">ScalarKind</a></td><td class="docblock-short"><p>Primitive type for a scalar.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ScalarValue.html" title="naga::ScalarValue enum">ScalarValue</a></td><td class="docblock-short"><p>A literal scalar value, used in constants.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.ShaderStage.html" title="naga::ShaderStage enum">ShaderStage</a></td><td class="docblock-short"><p>Stage of the programmable pipeline.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.Statement.html" title="naga::Statement enum">Statement</a></td><td class="docblock-short"><p>Instructions which make up an executable block.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.StorageClass.html" title="naga::StorageClass enum">StorageClass</a></td><td class="docblock-short"><p>Class of storage for variables.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.StorageFormat.html" title="naga::StorageFormat enum">StorageFormat</a></td><td class="docblock-short"></td></tr><tr class="module-item"><td><a class="enum" href="enum.SwizzleComponent.html" title="naga::SwizzleComponent enum">SwizzleComponent</a></td><td class="docblock-short"><p>Component selection for a vector swizzle.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.TypeInner.html" title="naga::TypeInner enum">TypeInner</a></td><td class="docblock-short"><p>Enum with additional information, depending on the kind of type.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.UnaryOperator.html" title="naga::UnaryOperator enum">UnaryOperator</a></td><td class="docblock-short"><p>Operation that can be applied on a single value.</p>
</td></tr><tr class="module-item"><td><a class="enum" href="enum.VectorSize.html" title="naga::VectorSize enum">VectorSize</a></td><td class="docblock-short"><p>Number of components in a vector.</p>
</td></tr></table><h2 id="constants" class="section-header"><a href="#constants">Constants</a></h2>
<table><tr class="module-item"><td><a class="constant" href="constant.BOOL_WIDTH.html" title="naga::BOOL_WIDTH constant">BOOL_WIDTH</a></td><td class="docblock-short"><p>Width of a boolean type, in bytes.</p>
</td></tr></table><h2 id="types" class="section-header"><a href="#types">Type Definitions</a></h2>
<table><tr class="module-item"><td><a class="type" href="type.Block.html" title="naga::Block type">Block</a></td><td class="docblock-short"><p>A code block is just a vector of statements.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.Bytes.html" title="naga::Bytes type">Bytes</a></td><td class="docblock-short"><p>Number of bytes per scalar.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.FastHashMap.html" title="naga::FastHashMap type">FastHashMap</a></td><td class="docblock-short"><p>Hash map that is faster but not resilient to DoS attacks.</p>
</td></tr><tr class="module-item"><td><a class="type" href="type.FastHashSet.html" title="naga::FastHashSet type">FastHashSet</a></td><td class="docblock-short"><p>Hash set that is faster but not resilient to DoS attacks.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../" data-current-crate="naga" data-search-index-js="../search-index.js" data-search-js="../search.js"></div><script src="../main.js"></script></body></html>